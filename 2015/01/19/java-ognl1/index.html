<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Java，JVM，Redis，Hbase，分布式，Mongo"><title>Java-OGNL 入门 | 任春晓的博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Java-OGNL 入门</h1><a id="logo" href="/.">任春晓的博客</a><p class="description">学而不思则罔，思而不学则殆</p></div><div id="nav-menu"><a href="/"><i class="fa fa-home"> 首页</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Java-OGNL 入门</h1><div class="post-meta">Jan 19, 2015<span> | </span><span class="category"><a href="/categories/java-ognl/">java-ognl</a></span></div><div class="post-content"><blockquote>
<p>OGNL 是 Object-Graph Navigation Language 的缩写，它是一种功能强大的表达式语言（Expression Language，简称为 EL），通过它简单一致的表达式语法，可以存取对象的任意属性，调用对象的方法，遍历整个对象的结构图，实现字段类型转化等功能。它使用相同的表达式去存取对象的属性。</p>
</blockquote>
<p>从语言角度来说：它是一个功能强大的表达式语言，用来获取和设置 java 对象的属性 ，它旨在提供一个更高抽象度语法来对 java 对象图进行导航。另外，java 中很多可以做的事情，也可以使用 OGNL 来完成，例如：列表映射和选择。对于开发者来说，使用 OGNL，可以用简洁的语法来完成对 java 对象的导航。通常来说：通过一个“路径”来完成对象信息的导航，这个“路径”可以是到 java bean 的某个属性，或者集合中的某个索引的对象，等等，而不是直接使用 get 或者 set 方法来完成。</p>
<h4 id="首先来介绍下OGNL的三要素："><a href="#首先来介绍下OGNL的三要素：" class="headerlink" title="首先来介绍下OGNL的三要素："></a>首先来介绍下OGNL的三要素：</h4><p><strong>一、表达式：</strong></p>
<p>表达式（Expression）是整个 OGNL 的核心内容，所有的 OGNL 操作都是针对表达式解析后进行的。通过表达式来告诉 OGNL 操作到底要干些什么。因此，表达式其实是一个带有语法含义的字符串，整个字符串将规定操作的类型和内容。OGNL 表达式支持大量的表达式，如“链式访问对象”、表达式计算、甚至还支持 Lambda 表达式。</p>
<p><strong>二、Root对象：</strong></p>
<p>OGNL 的 Root 对象可以理解为 OGNL 的操作对象。当我们指定了一个表达式的时候，我们需要指定这个表达式针对的是哪个具体的对象。而这个具体的对象就是 Root 对象，这就意味着，如果有一个 OGNL 表达式，那么我们需要针对 Root 对象来进行 OGNL 表达式的计算并且返回结果。</p>
<p><strong>三、上下文环境：</strong></p>
<p>有个 Root 对象和表达式，我们就可以使用 OGNL 进行简单的操作了，如对 Root 对象的赋值与取值操作。但是，实际上在 OGNL 的内部，所有的操作都会在一个特定的数据环境中运行。这个数据环境就是上下文环境（Context）。OGNL 的上下文环境是一个 Map 结构，称之为 OgnlContext。Root 对象也会被添加到上下文环境当中去。</p>
<h4 id="OGNL-的基本语法："><a href="#OGNL-的基本语法：" class="headerlink" title="OGNL 的基本语法："></a>OGNL 的基本语法：</h4><p><strong>一、对Root对象的访问</strong></p>
<p>OGNL 使用的是一种链式的风格进行对象的访问。具体代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOgnl</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User(<span class="string">"rcx"</span>, <span class="string">"123"</span>);</span><br><span class="line">    Address address = <span class="keyword">new</span> Address(<span class="string">"110003"</span>, <span class="string">"沈阳市和平区"</span>);</span><br><span class="line">    user.setAddress(address);</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(Ognl.getValue(<span class="string">"name"</span>, user));</span><br><span class="line">        System.out.println(Ognl.getValue(<span class="string">"address"</span>, user));</span><br><span class="line">        System.out.println(Ognl.getValue(<span class="string">"address.port"</span>, user));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//输出结果：</span></span><br><span class="line">       <span class="comment">//rcx</span></span><br><span class="line">       <span class="comment">//com.rcx.ognl.Address@dda25b</span></span><br><span class="line">       <span class="comment">//110003</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (OgnlException e)</span><br><span class="line">    &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>二、对上下文对象的访问</strong></p>
<p>使用 OGNL 的时候如果不设置上下文对象，系统会自动创建一个上下文对象，如果传入的参数当中包含了上下文对象则会使用传入的上下文对象。当访问上下文环境当中的参数时候，需要在表达式前面加上 ‘#’，表示了与访问 Root 对象的区别。具体代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOgnl1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       User user = <span class="keyword">new</span> User(<span class="string">"rcx"</span>, <span class="string">"123"</span>);</span><br><span class="line">       Address address = <span class="keyword">new</span> Address(<span class="string">"110003"</span>, <span class="string">"沈阳市和平区"</span>);</span><br><span class="line">       user.setAddress(address);</span><br><span class="line">       Map&lt;String, Object&gt; context = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">       context.put(<span class="string">"init"</span>, <span class="string">"hello"</span>);</span><br><span class="line">       context.put(<span class="string">"user"</span>, user);</span><br><span class="line">       <span class="keyword">try</span></span><br><span class="line">       &#123;</span><br><span class="line">           System.out.println(Ognl.getValue(<span class="string">"#init"</span>, context, user));</span><br><span class="line">           System.out.println(Ognl.getValue(<span class="string">"#user.name"</span>, context, user));</span><br><span class="line">           System.out.println(Ognl.getValue(<span class="string">"name"</span>, context, user));</span><br><span class="line">           <span class="comment">//输出结果：</span></span><br><span class="line">           <span class="comment">//hello</span></span><br><span class="line">           <span class="comment">//rcx</span></span><br><span class="line">           <span class="comment">//rcx</span></span><br><span class="line">        &#125;</span><br><span class="line">       <span class="keyword">catch</span> (OgnlException e)</span><br><span class="line">       &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p><strong>三、对静态变量的访问</strong></p>
<p>在 OGNL 表达式当中也可以访问静态变量或者调用静态方法，格式如 @[class]@[field/method()]。具体代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Constant</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String ONE = <span class="string">"one"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"string"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOgnl2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            Object object = Ognl.getValue(<span class="string">"@com.rcx.ognl.Constant@ONE"</span>, <span class="keyword">null</span>);</span><br><span class="line">            Object object1 = Ognl.getValue(<span class="string">"@com.rcx.ognl.Constant@get()"</span>, <span class="keyword">null</span>);</span><br><span class="line">            Object object2 = Ognl.getValue(<span class="string">"@com.rcx.ognl.Constant@getString()"</span>, <span class="keyword">null</span>);</span><br><span class="line">            System.out.println(object);</span><br><span class="line">            System.out.println(object1);</span><br><span class="line">            System.out.println(object2);</span><br><span class="line">            <span class="comment">//one</span></span><br><span class="line">            <span class="comment">//null 当返回值是void的时候输出的是null</span></span><br><span class="line">            <span class="comment">//string</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (OgnlException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>四、方法的调用</strong></p>
<p>如果需要调用 Root 对象或者上下文对象当中的方法也可以使用 .+ 方法的方式来调用。甚至可以传入参数。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOgnl3</span><span class="params">()</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       User user = <span class="keyword">new</span> User();</span><br><span class="line">       Map&lt;String, Object&gt; context = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">       context.put(<span class="string">"name"</span>, <span class="string">"rcx"</span>);</span><br><span class="line">       context.put(<span class="string">"password"</span>, <span class="string">"password"</span>);</span><br><span class="line">       <span class="keyword">try</span></span><br><span class="line">       &#123;</span><br><span class="line">           System.out.println(Ognl.getValue(<span class="string">"getName()"</span>, context, user));</span><br><span class="line">           Ognl.getValue(<span class="string">"setName(#name)"</span>, context, user);</span><br><span class="line">           System.out.println(Ognl.getValue(<span class="string">"getName()"</span>, context, user));</span><br><span class="line">           <span class="comment">//输出结果</span></span><br><span class="line">           <span class="comment">//null</span></span><br><span class="line">           <span class="comment">//rcx</span></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">catch</span> (OgnlException e)</span><br><span class="line">       &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>从代码可以看出来，赋值的时候可以选择上下文当中的元素进行给 Root 对象的 name 属性赋值。</p>
<p><strong>五、对数组和集合的访问</strong></p>
<p>OGNL 支持对数组按照数组下标的顺序进行访问。此方式也适用于对集合的访问，对于 Map 支持使用键进行访问。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOgnl4</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    Map&lt;String, Object&gt; context = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    String[] strings  = &#123;<span class="string">"aa"</span>, <span class="string">"bb"</span>&#125;;</span><br><span class="line">    ArrayList&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    list.add(<span class="string">"aa"</span>);</span><br><span class="line">    list.add(<span class="string">"bb"</span>);</span><br><span class="line">    Map&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">    map.put(<span class="string">"key1"</span>, <span class="string">"value1"</span>);</span><br><span class="line">    map.put(<span class="string">"key2"</span>, <span class="string">"value2"</span>);</span><br><span class="line">    context.put(<span class="string">"list"</span>, list);</span><br><span class="line">    context.put(<span class="string">"strings"</span>, strings);</span><br><span class="line">    context.put(<span class="string">"map"</span>, map);</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(Ognl.getValue(<span class="string">"#strings[0]"</span>, context, user));</span><br><span class="line">        System.out.println(Ognl.getValue(<span class="string">"#list[0]"</span>, context, user));</span><br><span class="line">        System.out.println(Ognl.getValue(<span class="string">"#list[0 + 1]"</span>, context, user));</span><br><span class="line">        System.out.println(Ognl.getValue(<span class="string">"#map['key1']"</span>, context, user));</span><br><span class="line">        System.out.println(Ognl.getValue(<span class="string">"#map['key' + '2']"</span>, context, user));</span><br><span class="line">        <span class="comment">//输出如下：</span></span><br><span class="line">        <span class="comment">//aa</span></span><br><span class="line">        <span class="comment">//aa</span></span><br><span class="line">        <span class="comment">//bb</span></span><br><span class="line">        <span class="comment">//value1</span></span><br><span class="line">        <span class="comment">//value2</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (OgnlException e)</span><br><span class="line">    &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从上面代码不仅看到了访问数组与集合的方式同时也可以看出来 OGNL 表达式当中支持操作符的简单运算。有如下所示：</p>
<p>2 + 4 //整数相加（同时也支持减法、乘法、除法、取余[ % / mod]、）</p>
<p>“hell” + “lo” //字符串相加</p>
<p>i++ //递增、递减</p>
<p>i == j //判断</p>
<p>var in list //是否在容器当中</p>
<p><strong>六、投影与选择</strong></p>
<p>OGNL 支持类似数据库当中的选择与投影功能。</p>
<p>投影：选出集合当中的相同属性组合成一个新的集合。语法为 collection.{XXX}，XXX 就是集合中每个元素的公共属性。</p>
<p>选择：选择就是选择出集合当中符合条件的元素组合成新的集合。语法为 collection.{Y XXX}，其中 Y 是一个选择操作符，XXX 是选择用的逻辑表达式。</p>
<p>选择操作符有 3 种：</p>
<ul>
<li>? ：选择满足条件的所有元素</li>
<li>^：选择满足条件的第一个元素</li>
<li>#：选择满足条件的最后一个元素</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOgnl5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Person p1 = <span class="keyword">new</span> Person(<span class="number">1</span>, <span class="string">"name1"</span>);</span><br><span class="line">        Person p2 = <span class="keyword">new</span> Person(<span class="number">2</span>, <span class="string">"name2"</span>);</span><br><span class="line">        Person p3 = <span class="keyword">new</span> Person(<span class="number">3</span>, <span class="string">"name3"</span>);</span><br><span class="line">        Person p4 = <span class="keyword">new</span> Person(<span class="number">4</span>, <span class="string">"name4"</span>);</span><br><span class="line">        Map&lt;String, Object&gt; context = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        ArrayList&lt;Person&gt; list = <span class="keyword">new</span> ArrayList&lt;Person&gt;();</span><br><span class="line">        list.add(p1);</span><br><span class="line">        list.add(p2);</span><br><span class="line">        list.add(p3);</span><br><span class="line">        list.add(p4);</span><br><span class="line">        context.put(<span class="string">"list"</span>, list);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            ArrayList&lt;Integer&gt; list2 = (ArrayList&lt;Integer&gt;) Ognl.getValue(<span class="string">"#list.&#123;id&#125;"</span>, context,</span><br><span class="line">                    list);</span><br><span class="line">            ArrayList&lt;String&gt; list3 = (ArrayList&lt;String&gt;) Ognl.getValue(<span class="string">"#list.&#123;id + '-' + name&#125;"</span>,</span><br><span class="line">                    context, list);</span><br><span class="line">            ArrayList&lt;Person&gt; list4 = (ArrayList&lt;Person&gt;) Ognl.getValue(<span class="string">"#list.&#123;? #this.id &gt; 2&#125;"</span>,</span><br><span class="line">                    context, list);</span><br><span class="line">            ArrayList&lt;Person&gt; list5 = (ArrayList&lt;Person&gt;) Ognl.getValue(<span class="string">"#list.&#123;^ #this.id &gt; 2&#125;"</span>,</span><br><span class="line">                    context, list);</span><br><span class="line">            ArrayList&lt;Person&gt; list6 = (ArrayList&lt;Person&gt;) Ognl.getValue(<span class="string">"#list.&#123;$ #this.id &gt; 2&#125;"</span>,</span><br><span class="line">                    context, list);</span><br><span class="line">            System.out.println(list2);</span><br><span class="line">            System.out.println(list3);</span><br><span class="line">            System.out.println(list4);</span><br><span class="line">            System.out.println(list5);</span><br><span class="line">            System.out.println(list6);</span><br><span class="line">            <span class="comment">//[1, 2, 3, 4]</span></span><br><span class="line">            <span class="comment">//[1-name1, 2-name2, 3-name3, 4-name4]</span></span><br><span class="line">            <span class="comment">//[Person [id=3, name=name3], Person [id=4, name=name4]]</span></span><br><span class="line">            <span class="comment">//[Person [id=3, name=name3]]</span></span><br><span class="line">            <span class="comment">//[Person [id=4, name=name4]]</span></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (OgnlException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>七、创建对象</strong></p>
<p>OGNL 支持直接使用表达式来创建对象。主要有三种情况：</p>
<p>构造 List 对象：使用 {},中间使用 ‘,’ 进行分割如 {“aa”, “bb”, “cc”}</p>
<p>构造 Map 对象：使用 #{}，中间使用 ‘,’ 进行分割键值对，键值对使用 ‘:’ 区分，如 #{“key1” : “value1”, “key2” : “value2”}</p>
<p>构造任意对象：直接使用已知的对象的构造方法进行构造。</p>
<p>示例代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOgnl6</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        Map&lt;String, String&gt; map = (Map&lt;String, String&gt;)Ognl.getValue(<span class="string">"#&#123;'key1':'value1'&#125;"</span>, <span class="keyword">null</span>);</span><br><span class="line">        System.out.println(map);</span><br><span class="line">        List&lt;String&gt; list = (List&lt;String&gt;)Ognl.getValue(<span class="string">"&#123;'key1','value1'&#125;"</span>, <span class="keyword">null</span>);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        Object object = Ognl.getValue(<span class="string">"new java.lang.Object()"</span>, <span class="keyword">null</span>);</span><br><span class="line">        System.out.println(object);</span><br><span class="line">        <span class="comment">//&#123;key1=value1&#125;</span></span><br><span class="line">        <span class="comment">//[key1, value1]</span></span><br><span class="line">        <span class="comment">//java.lang.Object@dda25b</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (OgnlException e)</span><br><span class="line">    &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>—EOF—</p>
</div><div class="tags"><a href="/tags/java-ognl/">java ognl</a></div><div class="post-nav"><a class="pre" href="/2015/01/19/jdbc-learn3/">JDBC 之使用</a><a class="next" href="/2015/01/17/jdbc-learn1/">Jdbc入门</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Bootstrap学习/">Bootstrap学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch/">Elasticsearch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JVM/">JVM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java解惑/">Java解惑</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/c/">c</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/cache/">cache</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/eclipse/">eclipse</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/effective-java/">effective-java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/go/">go</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/guava/">guava</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/html/">html</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/http/">http</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/j2ee/">j2ee</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-ognl/">java-ognl</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javaNIO/">javaNIO</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java基础/">java基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jdbc/">jdbc</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jms/">jms</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js基础/">js基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/junit/">junit</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/log/">log</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lua/">lua</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/maven/">maven</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mybatis/">mybatis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/scala/">scala</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tcp-ip/">tcp/ip</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vim/">vim</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/websocket/">websocket</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/代码优化/">代码优化</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/分布式架构/">分布式架构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/折腾/">折腾</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库连接池/">数据库连接池</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构/">数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/正则表达式/">正则表达式</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/理解计算机/">理解计算机</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/程序员修炼/">程序员修炼</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/重构/">重构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/页面设计/">页面设计</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">任春晓的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>